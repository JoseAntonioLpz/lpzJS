/*
*
* AUTHOR: José Antonio López López
* GITHUB: https://github.com/JoseAntonioLpz
* REPOSITORY: https://github.com/JoseAntonioLpz/lpzJS
* LICENSE: MIT
* 
*/
function graphic(t){let e=t.getContext("2d"),l=t.height,a=t.width;e.clearRect(0,0,a,l);let i=JSON.parse(t.dataset.json),n=null!=t.dataset.title?t.dataset.title:"",o=null!=t.dataset.color?t.dataset.color:"blue",s=[];i.forEach(function(t){s.push(t.value)});let r=Math.max(...s);e.beginPath(),e.strokeStyle="black",e.moveTo(25,10),e.lineTo(25,l-15),e.lineTo(a,l-15),e.stroke(),e.beginPath(),e.font="10px Arial",e.fillText(r,0,20),e.beginPath(),e.font="10px Arial",e.fillText(r/2,0,(l-15)/2),e.beginPath(),e.font="10px Arial",e.fillText(0,0,l-15),e.beginPath(),e.fillText(n,30,20);let c=25,f=25,h=l-15-(i[0].value*(l-15)/r-15),d=null!=t.dataset.sep?t.dataset.sep:"55";i.forEach(function(t){let a=l-15-(t.value*(l-15)/r-15);e.beginPath(),e.fillStyle=o,e.arc(c,a,3,0,2*Math.PI,!0),e.fill(),e.beginPath(),e.strokeStyle=o,e.moveTo(f,h),e.lineTo(c,a),e.stroke(),e.beginPath(),e.fillStyle="black",e.font="10px Arial",e.fillText(t.name,c,l),f=c,h=a,c+=parseInt(d)})}function circle(t){let e=t.getContext("2d"),l=t.height,a=t.width;e.clearRect(0,0,a,l);let i=JSON.parse(t.dataset.json),n=null!=t.dataset.title?t.dataset.title:"";var o=0;i.forEach(function(t){o+=parseInt(t.value)});let s=0,r=0,c=1;i.forEach(function(t){let i=100*t.value/o;r+=2*i/100*Math.PI,e.beginPath(),e.moveTo(a/2.5,l/2.5),e.fillStyle=t.color,e.arc(a/2.5,l/2.5,a/2.5,s,r,!1),e.fill(),e.save(),s=r,e.beginPath(),e.fillRect(a-65,12*c-9,10,10),e.fillStyle="black",e.font="10px Arial",e.fillText(t.name,a-50,0+12*c),e.restore(),c++}),e.beginPath(),e.fillStyle="black",e.font="10px Arial",e.fillText(n,0,l-20)}function graphicBar(t){let e=t.getContext("2d"),l=t.width,a=t.height;e.clearRect(0,0,l,a);let i=null!=t.dataset.title?t.dataset.title:"";e.fillStyle="black",e.font="10px Arial",e.fillText(i,25,12),e.beginPath(),e.moveTo(0,0),null==t.dataset.lline||"1"==t.dataset.lline?e.lineTo(0,a-15):e.moveTo(0,a-15),null!=t.dataset.bline&&"1"!=t.dataset.bline||e.lineTo(l,a-15),e.strokeStyle=null!=t.dataset.bcolor?t.dataset.bcolor:"black",e.stroke();let n=JSON.parse(t.dataset.json),o=[],s=0;n.forEach(function(t){o.push(t.value),s++});let r=Math.max(...o),c=1,f=r,h=r/4;e.beginPath();for(var d=0;d<4;d++)e.moveTo(0,c),e.lineTo(l,c),e.lineWidth=1,e.strokeStyle="#e1e1e1",e.stroke(),e.fillStyle="#e1e1e1",e.font="10px Arial",e.textAlign="center",e.fillText(f,10,c+12),f-=h,c+=(a-15)/4;e.closePath();let u=l/s-10,g=null!=t.dataset.min?t.dataset.min:u,p=null!=t.dataset.max?t.dataset.max:u,b=l/s-p,x=null!=t.dataset.sep?parseInt(t.dataset.sep):b,T=(l-x*(n.length+1))/n.length;g>T?T=parseInt(g):p<T&&(T=parseInt(p));let v=x,m=null!=t.dataset.color?t.dataset.color:"blue",P=null!=t.dataset.valcol?t.dataset.valcol:"white";e.beginPath(),n.forEach(function(l){let i=l.value*(a-15)/r;e.fillStyle=m,e.fillRect(v,a-15-i,T,i),e.fillStyle="black",e.font="10px Arial",e.textAlign="center";let n=null!=t.dataset.sbs?l.name.substring(0,parseInt(t.dataset.sbs)):l.name;e.fillText(n,v+T/2,a-5),e.save(),e.fillStyle=P,e.font="10px Arial",e.textAlign="center",e.fillText(l.value,v+T/2,a-i),e.restore(),v=v+T+x}),e.closePath()}!function(){var t=document.getElementsByTagName("canvas");for(let e of t)switch(e.className){case"graphic_bar_lpz":graphicBar(e);break;case"circle_lpz":circle(e);break;case"graphic_lpz":graphic(e)}}();